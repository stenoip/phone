<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>StenoCell</title>
</head>
<body>
  <h1>StenoCell</h1>

  <p id="myId">Loading your Etikettering...</p>

  <div>
    <label for="callee">Enter Etikettering to call:</label>
    <input type="text" id="callee" placeholder="e.g., SC-abc123xyz">
    <button id="callBtn">Call</button>
    <button id="hangupBtn" disabled>Hang Up</button>
  </div>

  <h2>Status</h2>
  <pre id="status">Idle</pre>

  <h2>Audio</h2>
  <p>Remote audio will play here when connected:</p>
  <audio id="remoteAudio" autoplay></audio>

  <footer>
    <p>Copyright 2025 Stenoip Company</p>
  </footer>

  <script>
                      // script.js
const WS_URL = "wss://phone-one-iota.vercel.app/api/socket";

// Prompt user for their ID
const id = prompt("Your ID (e.g., alice):")?.trim();

// Create WebSocket connection
const ws = new WebSocket(WS_URL);

// When connection opens, register this client
ws.onopen = () => {
  if (id) {
    ws.send(JSON.stringify({ type: "register", id }));
    console.log(`Registered as: ${id}`);
  } else {
    console.warn("No ID entered â€” registration skipped.");
  }
};

// Handle incoming messages
ws.onmessage = (e) => {
  try {
    const msg = JSON.parse(e.data);
    console.log("IN:", msg);

    // TODO: Handle 'offer', 'answer', 'candidate' messages here
    // Example:
    // if (msg.type === "offer") { ... }
  } catch (err) {
    console.error("Error parsing message:", err);
  }
};

// Helper functions to send signaling messages
function sendOffer(to, offer) {
  ws.send(JSON.stringify({ type: "offer", to, offer }));
}

function sendAnswer(to, answer) {
  ws.send(JSON.stringify({ type: "answer", to, answer }));
}

function sendCandidate(to, candidate) {
  ws.send(JSON.stringify({ type: "candidate", to, candidate }));
}

// Optional: keepalive ping every 25 seconds
setInterval(() => {
  if (ws.readyState === WebSocket.OPEN) {
    ws.send(JSON.stringify({ type: "ping" }));
  }
}, 25000);

  </script>
</body>
</html>
